using System.Collections.Generic;
using System.Linq;

namespace Silvestre.Pshychology.Tools.WISC3.Calculator.ConvertionScales.Portugal
{
    internal class CompleteSubscale : ConvertionScaleByLookup
    {
        private static readonly IDictionary<short, (short QI, decimal Percentile, (short, short) Per90, (short, short) Per95)> _lookupTable = new Dictionary<short, (short, decimal, (short, short), (short, short))>
        {
            { 10,   (40,  0m,       (39, 54),   (38, 55)) },
            { 11,   (41,  0m,       (40, 55),   (39, 56)) },
            { 12,   (42,  0m,       (41, 56),   (40, 57)) },
            { 13,   (43,  0m,       (42, 57),   (41, 58)) },
            { 14,   (44,  0m,       (43, 57),   (41, 59)) },
            { 15,   (45,  0m,       (44, 58),   (42, 60)) },
            { 16,   (46,  0m,       (45, 59),   (43, 61)) },
            { 17,   (47,  0m,       (46, 60),   (44, 62)) },
            { 18,   (47,  0m,       (46, 60),   (44, 62)) },
            { 19,   (47,  0m,       (46, 60),   (44, 62)) },
            { 20,   (48,  0m,       (46, 61),   (45, 62)) },
            { 21,   (48,  0m,       (46, 61),   (45, 62)) },
            { 22,   (49,  0m,       (47, 62),   (46, 63)) },
            { 23,   (50,  0m,       (48, 63),   (47, 64)) },
            { 24,   (51,  0.1m,     (49, 64),   (48, 65)) },
            { 25,   (51,  0.1m,     (49, 64),   (48, 65)) },
            { 26,   (52,  0.1m,     (50, 65),   (49, 66)) },
            { 27,   (52,  0.1m,     (50, 65),   (49, 66)) },
            { 28,   (53,  0.1m,     (51, 65),   (49, 67)) },
            { 29,   (53,  0.1m,     (51, 65),   (49, 67)) },
            { 30,   (54,  0.1m,     (52, 66),   (50, 68)) },
            { 31,   (54,  0.1m,     (52, 66),   (50, 68)) },
            { 32,   (54,  0.1m,     (52, 66),   (50, 68)) },
            { 33,   (55,  0.1m,     (53, 67),   (51, 69)) },
            { 34,   (55,  0.1m,     (53, 67),   (51, 69)) },
            { 35,   (55,  0.1m,     (53, 67),   (51, 69)) },
            { 36,   (56,  0.2m,     (54, 68),   (52, 70)) },
            { 37,   (56,  0.2m,     (54, 68),   (52, 70)) },
            { 38,   (56,  0.2m,     (54, 68),   (52, 70)) },
            { 39,   (57,  0.2m,     (54, 69),   (53, 70)) },
            { 40,   (57,  0.2m,     (54, 69),   (53, 70)) },
            { 41,   (57,  0.2m,     (54, 69),   (53, 70)) },
            { 42,   (58,  0.3m,     (55, 70),   (54, 71)) },
            { 43,   (58,  0.3m,     (55, 70),   (54, 71)) },
            { 44,   (59,  0.3m,     (56, 71),   (55, 72)) },
            { 45,   (60,  0.4m,     (57, 72),   (56, 73)) },
            { 46,   (61,  0.5m,     (58, 73),   (57, 74)) },
            { 47,   (61,  0.5m,     (58, 73),   (57, 74)) },
            { 48,   (62,  0.6m,     (59, 73),   (57, 75)) },
            { 49,   (62,  0.6m,     (59, 73),   (57, 75)) },
            { 50,   (62,  0.6m,     (59, 73),   (57, 75)) },
            { 51,   (63,  0.7m,     (60, 74),   (58, 76)) },
            { 52,   (63,  0.7m,     (60, 74),   (58, 76)) },
            { 53,   (63,  0.7m,     (60, 74),   (58, 76)) },
            { 54,   (64,  0.8m,     (61, 75),   (59, 77)) },
            { 55,   (64,  0.8m,     (61, 75),   (59, 77)) },
            { 56,   (64,  0.8m,     (61, 75),   (59, 77)) },
            { 57,   (65,  1m,       (62, 76),   (60, 78)) },
            { 58,   (65,  1m,       (62, 76),   (60, 78)) },
            { 59,   (66,  1m,       (62, 77),   (61, 78)) },
            { 60,   (66,  1m,       (62, 77),   (61, 78)) },
            { 61,   (67,  1m,       (63, 78),   (62, 79)) },
            { 62,   (67,  1m,       (63, 78),   (62, 79)) },
            { 63,   (68,  2m,       (64, 79),   (63, 80)) },
            { 64,   (68,  2m,       (64, 79),   (63, 80)) },
            { 65,   (69,  2m,       (65, 80),   (64, 81)) },
            { 66,   (69,  2m,       (65, 80),   (64, 81)) },
            { 67,   (71,  3m,       (67, 81),   (65, 83)) },
            { 68,   (72,  3m,       (68, 82),   (66, 84)) },
            { 69,   (73,  4m,       (69, 83),   (67, 85)) },
            { 70,   (74,  4m,       (70, 84),   (68, 86)) },
            { 71,   (75,  5m,       (70, 85),   (69, 86)) },
            { 72,   (75,  5m,       (70, 85),   (69, 86)) },
            { 73,   (76,  6m,       (71, 86),   (70, 87)) },
            { 74,   (77,  6m,       (72, 87),   (71, 88)) },
            { 75,   (77,  6m,       (72, 87),   (71, 88)) },
            { 76,   (78,  7m,       (73, 88),   (72, 89)) },
            { 77,   (79,  8m,       (74, 89),   (73, 90)) },
            { 78,   (79,  8m,       (74, 89),   (73, 90)) },
            { 79,   (80,  9m,       (75, 90),   (74, 91)) },
            { 80,   (81,  10m,      (76, 90),   (74, 92)) },
            { 81,   (82,  12m,      (77, 91),   (75, 93)) },
            { 82,   (83,  13m,      (78, 92),   (76, 94)) },
            { 83,   (84,  14m,      (78, 93),   (77, 94)) },
            { 84,   (85,  16m,      (79, 94),   (78, 95)) },
            { 85,   (85,  16m,      (79, 94),   (78, 95)) },
            { 86,   (86,  18m,      (80, 95),   (79, 96)) },
            { 87,   (87,  19m,      (81, 96),   (80, 97)) },
            { 88,   (88,  21m,      (82, 97),   (81, 98)) },
            { 89,   (89,  23m,      (83, 98),   (82, 99)) },
            { 90,   (90,  25m,      (84, 98),   (82, 100)) },
            { 91,   (90,  25m,      (84, 98),   (82, 100)) },
            { 92,   (91,  27m,      (85, 99),   (83, 101)) },
            { 93,   (92,  30m,      (86, 100),  (84, 102)) },
            { 94,   (93,  32m,      (86, 101),  (85, 102)) },
            { 95,   (94,  34m,      (87, 102),  (86, 103)) },
            { 96,   (95,  37m,      (88, 103),  (87, 104)) },
            { 97,   (96,  39m,      (89, 104),  (88, 105)) },
            { 98,   (97,  42m,      (90, 105),  (89, 106)) },
            { 99,   (98,  45m,      (91, 106),  (90, 107)) },
            { 100,  (99,  47m,      (92, 106),  (90, 108)) },
            { 101,  (100, 50m,      (93, 107),  (91, 109)) },
            { 102,  (100, 50m,      (93, 107),  (91, 109)) },
            { 103,  (101, 53m,      (94, 108),  (92, 110)) },
            { 104,  (102, 55m,      (94, 109),  (93, 110)) },
            { 105,  (102, 55m,      (94, 109),  (93, 110)) },
            { 106,  (103, 58m,      (95, 110),  (94, 111)) },
            { 107,  (104, 61m,      (96, 111),  (95, 112)) },
            { 108,  (105, 63m,      (97, 112),  (96, 113)) },
            { 109,  (105, 63m,      (97, 112),  (96, 113)) },
            { 110,  (106, 65m,      (98, 113),  (97, 114)) },
            { 111,  (107, 68m,      (99, 114),  (98, 115)) },
            { 112,  (108, 70m,      (100, 114),  (98, 116)) },
            { 113,  (109, 72m,      (101, 115),  (99, 117)) },
            { 114,  (110, 75m,      (102, 116),  (100, 118)) },
            { 115,  (110, 75m,      (102, 116),  (100, 118)) },
            { 116,  (111, 77m,      (102, 117),  (101, 118)) },
            { 117,  (112, 79m,      (103, 118),  (102, 119)) },
            { 118,  (113, 81m,      (104, 119),  (103, 120)) },
            { 119,  (114, 82m,      (105, 120),  (104, 121)) },
            { 120,  (114, 82m,      (105, 120),  (104, 121)) },
            { 121,  (115, 84m,      (106, 121),  (105, 122)) },
            { 122,  (116, 86m,      (107, 122),  (106, 123)) },
            { 123,  (117, 87m,      (108, 122),  (106, 124)) },
            { 124,  (117, 87m,      (108, 122),  (106, 124)) },
            { 125,  (118, 88m,      (109, 123),  (107, 125)) },
            { 126,  (119, 90m,      (110, 124),  (108, 126)) },
            { 127,  (120, 91m,      (111, 125),  (109, 127)) },
            { 128,  (120, 91m,      (111, 125),  (109, 127)) },
            { 129,  (121, 92m,      (111, 126),  (110, 127)) },
            { 130,  (122, 93m,      (112, 127),  (111, 128)) },
            { 131,  (123, 94m,      (113, 128),  (112, 129)) },
            { 132,  (124, 94m,      (114, 129),  (113, 130)) },
            { 133,  (125, 95m,      (115, 130),  (114, 131)) },
            { 134,  (125, 95m,      (115, 130),  (114, 131)) },
            { 135,  (126, 96m,      (116, 130),  (114, 132)) },
            { 136,  (127, 96m,      (117, 131),  (115, 133)) },
            { 137,  (128, 97m,      (118, 132),  (116, 134)) },
            { 138,  (129, 97m,      (119, 133),  (117, 135)) },
            { 139,  (130, 98m,      (119, 134),  (118, 135)) },
            { 140,  (131, 98m,      (120, 135),  (119, 136)) },
            { 141,  (132, 98m,      (121, 136),  (120, 137)) },
            { 142,  (134, 99m,      (123, 138),  (122, 139)) },
            { 143,  (135, 99m,      (124, 138),  (122, 140)) },
            { 144,  (136, 99.2m,    (125, 139),  (123, 141)) },
            { 145,  (137, 99.3m,    (126, 140),  (124, 142)) },
            { 146,  (138, 99.4m,    (127, 141),  (125, 143)) },
            { 147,  (139, 99.5m,    (127, 142),  (126, 143)) },
            { 148,  (140, 99.6m,    (128, 143),  (127, 144)) },
            { 149,  (141, 99.7m,    (129, 144),  (128, 145)) },
            { 150,  (142, 99.7m,    (130, 145),  (129, 146)) },
            { 151,  (142, 99.7m,    (130, 145),  (129, 146)) },
            { 152,  (143, 99.8m,    (131, 146),  (130, 147)) },
            { 153,  (143, 99.8m,    (131, 146),  (130, 147)) },
            { 154,  (144, 99.8m,    (132, 146),  (130, 148)) },
            { 155,  (144, 99.8m,    (132, 146),  (130, 148)) },
            { 156,  (145, 99.9m,    (133, 147),  (131, 149)) },
            { 157,  (146, 99.9m,    (134, 148),  (132, 150)) },
            { 158,  (147, 99.9m,    (135, 149),  (133, 151)) },
            { 159,  (147, 99.9m,    (135, 149),  (133, 151)) },
            { 160,  (148, 99.9m,    (135, 150),  (134, 151)) },
            { 161,  (148, 99.9m,    (135, 150),  (134, 151)) },
            { 162,  (149, 99.9m,    (136, 151),  (135, 152)) },
            { 163,  (150, 99.9m,    (137, 152),  (136, 153)) },
            { 164,  (150, 100m,     (137, 152),  (136, 153)) },
            { 165,  (151, 100m,     (138, 153),  (137, 154)) },
            { 166,  (152, 100m,     (139, 154),  (138, 155)) },
            { 167,  (152, 100m,     (139, 154),  (138, 155)) },
            { 168,  (153, 100m,     (140, 154),  (138, 156)) },
            { 169,  (154, 100m,     (141, 155),  (139, 157)) },
            { 170,  (154, 100m,     (141, 155),  (139, 157)) },
            { 171,  (155, 100m,     (142, 156),  (140, 158)) },
            { 172,  (155, 100m,     (142, 156),  (140, 158)) },
            { 173,  (156, 100m,     (143, 157),  (141, 159)) },
            { 174,  (156, 100m,     (143, 157),  (141, 159)) },
            { 175,  (157, 100m,     (143, 158),  (142, 159)) },
            { 176,  (157, 100m,     (143, 158),  (142, 159)) },
            { 177,  (158, 100m,     (144, 159),  (143, 160)) },
            { 178,  (158, 100m,     (144, 159),  (143, 160)) },
            { 179,  (159, 100m,     (145, 160),  (144, 161)) },
            { 180,  (159, 100m,     (145, 160),  (144, 161)) },
            { 181,  (160, 100m,     (146, 161),  (145, 162)) },
            { 182,  (999, 100m,     (147, 162),  (146, 163)) },
            { 183,  (999, 100m,     (147, 162),  (146, 163)) },
            { 184,  (999, 100m,     (147, 162),  (146, 163)) },
            { 185,  (999, 100m,     (147, 162),  (146, 163)) },
            { 186,  (999, 100m,     (147, 162),  (146, 163)) },
            { 187,  (999, 100m,     (147, 162),  (146, 163)) },
            { 188,  (999, 100m,     (147, 162),  (146, 163)) },
            { 189,  (999, 100m,     (147, 162),  (146, 163)) },
            { 190,  (999, 100m,     (147, 162),  (146, 163)) }
        };

        protected internal override IDictionary<short, (short QI, decimal Percentile, (short, short) Per90, (short, short) Per95)> LookupTable => _lookupTable;

        protected override (short QI, decimal Percentile, (short, short) Per90, (short, short) Per95)? OnResultOutOfBounds(short results)
        {
            var maxValue = this.LookupTable.Keys.Max();
            return this.LookupTable[maxValue];
        }
    }
}
